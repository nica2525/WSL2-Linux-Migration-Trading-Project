# 📋 改善版タスク計画（Gemini査読反映）

**作成日**: 2025-07-29  
**査読者**: Gemini  
**改善版**: バッファ追加・リスク対策・実現性向上

---

## 🎯 プロジェクト現況
- **Phase 1完了**: ファイル監視ベースのダッシュボード基盤構築 ✅
- **E2E検証完了**: データフロー動作確認・堅牢性検証済み ✅
- **開発凍結解除**: Gemini承認により新規開発再開可能 ✅

## 📊 修正版Phase別タスク計画

### Phase 1 追加タスク（2-3日）
**目的**: 本番稼働のための最終調整
**Gemini改善**: バッファ追加・設計前倒し

1. **システム構成設計（新規追加）**
   - 全体アーキテクチャ図作成
   - データフロー設計図
   - SQLiteスキーマ設計（Phase 2先行準備）

2. **48時間連続稼働テスト**
   - メモリリーク確認
   - ファイルハンドルリーク確認
   - CPU使用率監視
   - **問題発見時の修正バッファ: +1日**

3. **過去スクリプト整理**
   - `legacy_scripts/`ディレクトリ作成
   - 29個のMT5関連スクリプト移動
   - 現行システムとの分離
   - 参照用インデックス作成

4. **運用ドキュメント作成**
   - 起動・停止手順書
   - トラブルシューティングガイド
   - システム構成図（上記設計を反映）

**調整期間**: 1日（Phase 2準備・品質確認）

---

### Phase 2 統計機能追加（5日）
**目的**: ダッシュボードに基本的な統計情報を追加
**Gemini改善**: データバリデーション層追加

1. **データバリデーション層実装（新規追加）**
   - MT5データ品質チェック機能
   - 不正データ検知・処理
   - エラーハンドリング強化

2. **データ永続化層追加**
   - SQLiteデータベース導入（設計済みスキーマ使用）
   - 取引履歴の保存機能
   - 統計データキャッシュ

3. **基本統計指標実装**
   - 勝率・連勝/連敗統計
   - 日次・週次・月次損益集計
   - 最大ドローダウン計算

4. **UI拡張**
   - 統計サマリーパネル追加
   - 期間別フィルター機能
   - CSVエクスポート機能

**調整期間**: 1日（Phase 3準備・統合テスト）

---

### Phase 3 高度な分析機能（7日）
**目的**: プロフェッショナル向け分析ツール実装

1. **高度な統計指標**
   - シャープレシオ・ソルティノレシオ
   - プロフィットファクター
   - リスクリワードレシオ分析

2. **チャート機能**
   - 損益曲線グラフ（Chart.js）
   - ドローダウンチャート
   - 時間帯別パフォーマンス

3. **アラート・通知機能**
   - 閾値ベースアラート
   - メール/Webhook通知（外部依存考慮）
   - リスク警告システム

4. **設定管理強化（新規追加）**
   - `Config/system_config.yaml`導入
   - アラート閾値・接続情報一元管理
   - ロギング機能強化

**調整期間**: 2日（Phase 4a準備・EA連携検証）

---

### Phase 4a EA統合・比較機能（5日）
**目的**: 必須EA連携機能のみ実装
**Gemini改善**: Phase 4を分割、必須機能のみに集中

1. **EA改善後の統合**
   - 新パラメータでのバックテスト
   - パフォーマンス比較機能
   - A/Bテスト支援機能

2. **基本最適化支援**
   - パラメータ感度分析（基本版）
   - Walk-Forward分析結果表示
   - 市場環境別パフォーマンス（基本版）

**調整期間**: 1日（Phase 4b検討・全体評価）

---

### Phase 4b 高度最適化機能（別途計画）
**目的**: 研究開発要素の強い高度機能
**Gemini改善**: 研究開発として別途計画・リスク分離

1. **高度最適化支援**
   - リアルタイム推奨設定
   - 市場環境判定機能（機械学習要素）
   - 自動パラメータ調整提案

**注意**: Phase 4aの成果とユーザーフィードバックを踏まえて実施判断

---

## 🔧 技術的実装優先順位（修正版）

### 即時実装（Phase 1-2）
1. **設計文書作成**: アーキテクチャ・DBスキーマ
2. **legacy_scripts整理**: 過去資産の整理・参照可能化
3. **データバリデーション**: 品質チェック基盤
4. **SQLite統合**: データ永続化基盤
5. **基本統計計算**: 勝率・DD等の必須指標

### 中期実装（Phase 2-3）
1. **チャート描画**: Chart.js等での可視化
2. **高度な統計**: NumPy/Pandasでの計算
3. **設定管理**: YAML設定ファイル
4. **通知システム**: 外部連携機能

### 長期実装（Phase 3-4a）
1. **EA連携基盤**: パラメータ比較・統合
2. **基本最適化**: 感度分析・WFA表示

### 研究開発（Phase 4b）
1. **AI分析統合**: MCP活用の高度分析
2. **自動最適化**: 機械学習ベースの提案機能

---

## 📝 実装方針（強化版）

### 品質保証
- **段階的機能追加**: Phase 1基盤を壊さない
- **テスト駆動開発**: 各機能に単体・統合テスト
- **Gemini定期査読**: 各Phase完了時に品質確認
- **調整期間活用**: 問題発見・修正のバッファ確保

### リスク管理
- **データ品質**: バリデーション層で早期検知
- **外部依存**: EA改善遅延への対策（Phase 4b分離）
- **スコープ管理**: 機能追加要望の Phase 4b 振り分け
- **スケジュール**: 各Phase間の調整期間でバッファ確保

### 運用設計
- **設定一元管理**: YAML設定ファイル
- **ログ強化**: 全処理の実行記録・エラー追跡
- **ユーザーフィードバック**: 実運用からの改善要望反映

---

## ⏱️ 修正版スケジュール

| Phase | 期間 | 完了予定 | バッファ |
|-------|------|----------|----------|
| **Phase 1追加** | 2-3日 | 8/1 | 問題修正 |
| **調整期間** | 1日 | 8/2 | 品質確認 |
| **Phase 2** | 5日 | 8/7 | - |
| **調整期間** | 1日 | 8/8 | 統合テスト |
| **Phase 3** | 7日 | 8/15 | - |
| **調整期間** | 2日 | 8/17 | EA連携準備 |
| **Phase 4a** | 5日 | 8/22 | - |
| **調整期間** | 1日 | 8/23 | 全体評価 |

**合計**: 約30日間（バッファ込み）  
**Phase 4b**: 別途計画（研究開発として）

---

## 🎯 成功基準

### Phase 1追加
- ✅ 48時間連続稼働成功
- ✅ 設計文書完成
- ✅ legacy_scripts整理完了

### Phase 2
- ✅ データバリデーション層動作
- ✅ SQLite統合・基本統計表示
- ✅ UI拡張・CSVエクスポート

### Phase 3
- ✅ 高度統計・チャート表示
- ✅ アラート・通知機能
- ✅ 設定管理・ログ強化

### Phase 4a
- ✅ EA統合・比較機能
- ✅ 基本最適化支援
- ✅ Phase 4b実施判断

---

## 📋 Gemini改善提案の反映状況

| 改善提案 | 反映内容 | 効果 |
|----------|----------|------|
| **バッファ導入** | 各Phase間に1-2日調整期間 | スケジュール遅延リスク軽減 |
| **Phase 4分割** | 4a（必須）・4b（研究開発）に分離 | 実現性向上・リスク分離 |
| **データバリデーション** | Phase 2最初に実装 | データ品質リスク軽減 |
| **設計前倒し** | Phase 1でアーキテクチャ・DB設計 | 手戻りリスク軽減 |
| **運用設計強化** | YAML設定・ログ強化 | 保守性・追跡性向上 |

**総評**: Gemini査読により実現性・堅牢性が大幅向上したタスク計画