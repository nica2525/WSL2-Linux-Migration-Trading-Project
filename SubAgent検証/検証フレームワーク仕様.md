# Sub-Agentフリーズ境界線検証フレームワーク

## 🎯 検証目的
Sub-Agent機能が安定動作する境界条件を特定し、実用的な使用ガイドラインを確立する

## 📊 検証パラメータ

### 1. ファイルサイズ境界
- **極小**: 1-10行（100-1KB）
- **小**: 50-100行（5-10KB）
- **中**: 500-1000行（50-100KB）
- **大**: 5000+行（500KB+）

### 2. ファイル数境界
- **単一**: 1ファイル
- **少数**: 5ファイル
- **中規模**: 20ファイル
- **大規模**: 100+ファイル

### 3. コンテキスト複雑度
- **単純**: 単一言語、単純構造
- **通常**: 複数言語、標準的な依存関係
- **複雑**: 多言語、相互依存、大量import
- **極大**: フルプロジェクトコンテキスト

### 4. タスク種別
- **読取**: ファイル検索・内容確認
- **分析**: コード解析・問題特定
- **編集**: 単一ファイル修正
- **実装**: 複数ファイル作成・編集

## 🧪 検証プロトコル

### フェーズ1: 基礎境界確認
1. **最小構成テスト**
   - 1ファイル、10行、読取タスク
   - 成功確認後、段階的拡大

2. **単一パラメータ変化**
   - ファイルサイズのみ増加
   - ファイル数のみ増加
   - 複雑度のみ増加

### フェーズ2: 複合条件テスト
1. **実用的組み合わせ**
   - 小規模プロジェクト想定
   - 中規模プロジェクト想定
   - 大規模プロジェクト想定

2. **限界探索**
   - フリーズ発生条件の特定
   - 警告サイン識別

### フェーズ3: 回避策検証
1. **タスク分割手法**
   - 効果的な分割粒度
   - コンテキスト管理方法

2. **前処理最適化**
   - 不要ファイル除外
   - コンテキスト最小化

## 📝 検証記録フォーマット

### テストケース記録
```yaml
test_id: "T001"
timestamp: "2025-07-31 10:00:00"
parameters:
  file_size: "small"
  file_count: 1
  complexity: "simple"
  task_type: "read"
result:
  status: "success|freeze|error"
  execution_time: "秒"
  memory_usage: "MB"
  cpu_peak: "%"
  error_details: ""
notes: "観察事項"
```

### 境界線マトリクス
| ファイルサイズ | ファイル数 | 複雑度 | 結果 | 実行時間 |
|---|---|---|---|---|
| 小 | 1 | 単純 | ✅ | 5秒 |
| 中 | 5 | 通常 | ⚠️ | 30秒 |
| 大 | 20 | 複雑 | ❌ | フリーズ |

## 🚨 安全対策

### フリーズ検出
- 30秒無応答 → 警告
- 60秒無応答 → 中断検討
- 120秒無応答 → 強制終了

### リカバリー手順
1. Ctrl+C で中断試行
2. 新ターミナルでプロセス確認
3. 必要時: `pkill -f "node.*claude"`
4. WSL再起動（最終手段）

## 📊 期待される成果

### 実用的ガイドライン
- 安全使用条件の明確化
- リスク評価基準
- 最適化推奨事項

### 段階的導入計画
1. **低リスクタスク**: 小規模読取
2. **中リスクタスク**: 中規模分析
3. **要注意タスク**: 大規模実装

## 🔄 継続的改善
- Claude Codeアップデート後の再検証
- ユーザーフィードバック反映
- 新パターン追加検証
