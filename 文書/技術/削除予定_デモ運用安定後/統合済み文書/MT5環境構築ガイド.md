# MT5環境構築ガイド

**作成日**: 2025年7月23日
**対象**: MT4→MT5移行プロジェクト
**ステータス**: 環境構築手順書

---

## 🎯 構築目標

### 最終目標
- OANDA MT5での自動売買環境完全構築
- JamesORB EA正常動作確認
- MCP連携基盤準備完了

### 効果予測
- **コスト削減**: 年間約15万円
- **スプレッド改善**: USDJPY 0.8-0.9銭 → 0.3-0.9銭
- **将来性**: AI-MT5直接連携対応

---

## 📋 必須作業チェックリスト

### Phase 1: MT5プラットフォーム導入
- [ ] **MT5公式ダウンロード**: MetaTrader 5公式サイトから最新版取得
- [ ] **インストール実行**: 標準設定でインストール
- [ ] **基本動作確認**: プラットフォーム起動・チャート表示
- [ ] **MetaEditor 5確認**: EA開発環境動作確認

### Phase 2: OANDA MT5口座準備
- [ ] **デモ口座開設**: OANDA MT5デモ口座申請
- [ ] **ログイン設定**: MT5プラットフォームへのログイン確認
- [ ] **通貨ペア確認**: USDJPY, EURUSD, GBPJPY等の表示確認
- [ ] **本番口座検討**: 必要に応じて本番口座開設検討

### Phase 3: EA開発環境構築
- [ ] **JamesORB_Standalone.mq5コンパイル**: MetaEditor 5でのコンパイル
- [ ] **エラー修正**: コンパイルエラーがあれば修正
- [ ] **EA配置**: Experts フォルダへの正しい配置
- [ ] **パラメータ設定**: 4パラメータの初期値確認

### Phase 4: バックテスト環境構築
- [ ] **ヒストリカルデータ確認**: MT5での履歴データ取得状況
- [ ] **QuantDataManager MT5対応**: MT5形式データエクスポート
- [ ] **テスト設定**: M5時間足・全ティック・期間設定
- [ ] **初回バックテスト**: 動作確認テスト実行

### Phase 5: MCP連携基盤準備
- [ ] **通信方式検討**: MT5⇔AI連携アーキテクチャ設計
- [ ] **プロトタイプ実装**: 基本的なデータ交換テスト
- [ ] **API設計**: MT5からのデータ取得・指示送信方式
- [ ] **セキュリティ確認**: 取引データ保護・認証方式

---

## 🔧 技術的考慮事項

### MQL4→MQL5主要変更対応
1. **関数変更**:
   - `OrderSend()` → `CTrade::OrderOpen()`
   - `OrderClose()` → `CTrade::PositionClose()`
   - `iATR()` → `CopyBuffer(iATR())`

2. **構造変更**:
   - `start()` → `OnTick()`
   - `init()` → `OnInit()`
   - `deinit()` → `OnDeinit()`

3. **データアクセス**:
   - `Time[0]` → `iTime()`
   - `High[1]` → `rates[].high`
   - 配列系列設定 `ArraySetAsSeries()`

### 注意事項
- **時間足設定**: M5での動作確認必須
- **スプレッド確認**: MT5での実際のスプレッド測定
- **レイテンシ**: 通信遅延の実測・最適化検討

---

## 🎯 成功判定基準

### 短期目標（1週間）
- [ ] MT5プラットフォーム正常動作
- [ ] JamesORB EA コンパイル成功
- [ ] OANDA MT5デモ口座接続成功
- [ ] 基本バックテスト実行成功

### 中期目標（2週間）
- [ ] EA実際取引動作確認
- [ ] スプレッド改善効果測定
- [ ] パフォーマンス比較（MT4 vs MT5）
- [ ] MCP連携プロトタイプ動作

### 長期目標（1ヶ月）
- [ ] 本格運用開始
- [ ] コスト削減効果確認
- [ ] AI連携システム実装
- [ ] 複数通貨対応テスト

---

## 🚨 リスク対策

### 移行リスク
1. **EA動作差異**: 厳密な比較テスト実施
2. **データ互換性**: バックテスト結果比較検証
3. **ブローカー仕様**: OANDA MT5固有仕様の確認

### 対策方針
- **段階的移行**: MT4並行運用期間設定
- **小額テスト**: リスク最小化での動作確認
- **緊急復帰**: 問題発生時のMT4復帰手順整備

---

## 📞 サポートリソース

### 公式リソース
- **MetaTrader 5公式**: https://www.metatrader5.com/
- **MQL5公式ドキュメント**: https://docs.mql4.com/
- **OANDA MT5ガイド**: OANDA公式サポートページ

### 内部リソース
- **移行計画書**: `文書/計画/MT4→MT5移行計画.md`
- **EA移植版**: `MT5_EA/JamesORB_Standalone.mq5`
- **セッション記録**: `文書/記録/セッション記録_2025-07-23_*.md`

---

**作成者**: Claude
**承認者**: kiro（設計・計画責任者）
**次回更新**: 環境構築完了時
