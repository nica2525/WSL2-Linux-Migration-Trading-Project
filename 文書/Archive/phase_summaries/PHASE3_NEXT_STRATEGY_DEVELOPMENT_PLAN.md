# フェーズ3: 次世代戦略開発計画

## 📅 計画期間
2025年7月8日開始 - Week 5-6（改革プラン継続）

---

## 🎯 フェーズ2からの重要な学習成果

### ✅ 成功要素
1. **WFA実装技術**: Purged & Embargoed WFAの完全実装成功
2. **統計的判断力**: 希望的観測ではなく科学的事実による判断
3. **プロセス設計**: 情報リーク防止の完全実装

### ❌ 改善要因
1. **取引頻度不足**: 8取引 < 75取引（最低基準）
2. **データ期間不足**: 2.7年 < 5年（推奨期間）
3. **時間制限**: 日本時間09:00-11:00の制約が統計的検証を困難に

---

## 🚀 フェーズ3戦略設計方針

### 1. 高頻度戦略への転換

#### 新戦略コンセプト: **「多時間軸ブレイクアウト」**
```
【基本方針】
時間制限を撤廃し、24時間取引可能な戦略設計
→ 年間取引数を大幅増加（200-500取引/年）
```

#### 戦略仕様（仮）
```
【エントリー条件】
1. 時間: 24時間対応（主要セッション重視）
2. 条件: 4時間足・1時間足の重複ブレイク
3. 確認: 15分足での再確認

【エグジット条件】
1. 利確: ATR倍数による動的設定
2. 損切: ATR倍数による動的設定
3. 時間: 48時間での強制決済
```

### 2. データ期間の拡張

#### データ要件
- **最低期間**: 5年間（2019-2024年）
- **推奨期間**: 7年間（2017-2024年）
- **代替案**: 複数通貨ペア並行検証

#### WFA設定調整
- **IS期間**: 18ヶ月（短縮でフォールド数増加）
- **OOS期間**: 6ヶ月（維持）
- **ステップ**: 6ヶ月（維持）
- **期待フォールド数**: 6-8個

### 3. 段階的検証アプローチ

#### Stage 1: 高速検証
```
【目的】基本的な優位性の確認
【方法】シンプルなIS/OOS分割（70/30）
【基準】OOS PF > 1.1 + 取引数 > 100
【期間】1-2セッション
```

#### Stage 2: WFA検証
```
【目的】統計的有意性の確認
【方法】Purged & Embargoed WFA
【基準】p < 0.05 + WFA効率 > 0.5
【期間】2-3セッション
```

---

## 🔬 具体的戦略候補

### 戦略A: マルチタイムフレーム・ブレイクアウト

#### 市場仮説
**「時間軸収束ブレイクアウト」**: 複数時間軸で同時にブレイクが発生する際、機関投資家の大口注文により強力なトレンドが形成される。

#### 技術仕様
```python
def multi_timeframe_breakout_signal(data, params):
    """
    マルチタイムフレーム・ブレイクアウト戦略
    
    Parameters:
    - h4_period: 4時間足の期間（デフォルト24 = 4日）
    - h1_period: 1時間足の期間（デフォルト24 = 1日）
    - atr_period: ATR期間（デフォルト14）
    - profit_atr: 利確ATR倍数（デフォルト2.0）
    - stop_atr: 損切ATR倍数（デフォルト1.5）
    """
    
    # H4とH1の高値・安値ブレイク判定
    h4_high_break = current_price > h4_high + threshold
    h1_high_break = current_price > h1_high + threshold
    
    # 両方でブレイクが発生
    if h4_high_break and h1_high_break:
        return "LONG_SIGNAL"
```

### 戦略B: セッション重複ブレイクアウト

#### 市場仮説
**「流動性集中効果」**: 主要セッション重複時間帯での価格ブレイクは、流動性の急激な増加により持続性が高い。

#### 技術仕様
```python
def session_overlap_breakout(data, params):
    """
    セッション重複ブレイクアウト戦略
    
    重複時間帯:
    - ロンドン・NY重複: 21:00-24:00 (GMT)
    - 東京・ロンドン重複: 08:00-09:00 (GMT)
    - 東京・NY重複: 13:00-15:00 (GMT)（夏時間調整）
    """
```

---

## 📊 実装ロードマップ

### Week 1: 戦略A基本実装
1. **多時間軸データ処理**: H4/H1データの統合処理
2. **ブレイクアウト判定**: 複数時間軸での同期判定
3. **ATR動的リスク管理**: 市場ボラティリティ対応
4. **Stage1検証**: シンプルなIS/OOS検証

### Week 2: WFA統合・統計検証
1. **WFA統合**: 戦略AとPurged & Embargoed WFAの統合
2. **統計的検証**: p値・DSR・WFA効率の計算
3. **結果分析**: 合格/不合格の客観的判定
4. **戦略Bバックアップ**: 戦略A不合格時の代替案

---

## 🎯 成功基準（改良版）

### 統計的基準
- **統計的有意性**: p < 0.05（必須）
- **取引数**: OOS期間で最低75取引（理想100取引以上）
- **WFA効率**: 0.5以上（IS性能の50%以上をOOSで維持）

### 実用性基準
- **プロフィットファクター**: OOS期間で1.1以上
- **最大ドローダウン**: 15%以下
- **勝率**: 30%以上（リスクリワード重視）

### 堅牢性基準
- **パラメータ安定性**: 小幅変更での性能維持
- **複数通貨ペア**: EURUSD以外での検証
- **異なる市場環境**: トレンド・レンジ両方での機能確認

---

## 💡 イノベーション要素

### 1. 適応型リスク管理
```python
def adaptive_risk_management(market_volatility, account_equity):
    """
    市場ボラティリティに応じたポジションサイズ調整
    → 高ボラ時: ポジション縮小
    → 低ボラ時: ポジション拡大
    """
```

### 2. 自動パフォーマンス監視
```python
def real_time_performance_monitor(current_equity, baseline_equity):
    """
    リアルタイムパフォーマンス監視
    → ドローダウン15%で自動停止
    → 統計的優位性の継続監視
    """
```

---

## 🛡️ リスク管理

### 開発リスク
- **複雑性制限**: パラメータ5個以下の維持
- **段階的検証**: Stage1→Stage2の確実な進行
- **タイムボックス**: 各段階の期間制限設定

### 統計的リスク
- **多重比較**: 戦略候補数の事前宣言
- **データマイニング**: 試行回数の厳格管理
- **過学習防止**: IS/OOS期間の厳格分離

---

## 📈 期待成果

### 技術的成果
- **取引頻度向上**: 年間200-500取引（10倍増）
- **統計的信頼性**: p < 0.05での優位性確認
- **実用性**: 実機環境での安定運用可能性

### 学習成果
- **多時間軸分析**: 複雑な市場構造の理解
- **適応型システム**: 市場環境変化への対応力
- **包括的検証**: 理論から実装まで一貫したプロセス

---

**🚀 フェーズ3で、フェーズ2の学習を完全に活かし、真の市場優位性を持つ戦略を構築します。**

**統計的厳密性と実用性を両立する、次世代の科学的EA開発を実現します。**