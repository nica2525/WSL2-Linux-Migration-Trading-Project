# 仮説駆動型EA開発ガイドライン

## 🧬 概要
「なんとなく」「試してみよう」から脱却し、明確な市場仮説に基づく科学的EA開発手法の実践ガイド。

---

## 🎯 仮説駆動開発の基本理念

### 従来の問題のあるアプローチ
```
💭 「RSIと移動平均を組み合わせたら勝てそう」
↓
🔧 すぐにコーディング開始
↓
📊 バックテストで良い結果が出るまで調整
↓
💸 実機で失敗
```

### 仮説駆動の正しいアプローチ
```
🧠 明確な市場仮説の策定
↓
📐 仮説検証のための戦略設計
↓
🔬 科学的検証プロセス
↓
✅ 統計的優位性の確認
↓
🚀 確信を持った実装
```

---

## 📋 仮説策定フレームワーク

### Step 1: 市場非効率性の特定

#### 質問テンプレート
1. **どのような市場の非効率性を狙うのか？**
   - [ ] 価格発見の遅延
   - [ ] 流動性の偏在
   - [ ] 情報伝達の時差
   - [ ] 参加者行動の偏向

2. **なぜその非効率性が存在するのか？**
   - [ ] 市場参加者の制約（時間、資金、技術）
   - [ ] 情報処理の限界
   - [ ] 心理的・感情的要因
   - [ ] 規制・制度的要因

3. **なぜその非効率性が今後も続くと考えるのか？**
   - [ ] 構造的要因（変化困難）
   - [ ] 参加者の本質的制約
   - [ ] 技術的障壁
   - [ ] 経済的インセンティブ

#### 仮説例テンプレート

**良い仮説の例**:
```
【仮説】東京市場開始時のブレイクアウト
【根拠】アジア時間の薄商いレンジから、ロンドン勢参入による
　　　　急激な流動性増加が方向性を生む
【期待効果】レンジ上下限突破時の初動を捉えることで、
　　　　　　トレンド継続の恩恵を受けられる
【持続性】時差と市場参加者構造は変わらないため、
　　　　　この非効率性は構造的に存在し続ける
```

**悪い仮説の例**:
```
【仮説】RSI30以下で買い、70以上で売り
【根拠】オシレーターが機能するから
【期待効果】逆張りで利益が出る
【持続性】不明
→ 市場の非効率性が不明確、根拠が薄弱
```

### Step 2: 戦略ロジックの導出

#### 仮説から戦略への変換プロセス
1. **エントリー条件**: 非効率性が発現する瞬間は？
2. **エグジット条件**: 非効率性が解消される条件は？
3. **時間軸**: その非効率性の持続時間は？
4. **市場環境**: どの市場状況で最も有効か？

#### 戦略設計原則
- [ ] **シンプル**: 核となるロジックは1つ
- [ ] **明確**: 誰でも理解可能な条件定義
- [ ] **測定可能**: 客観的な判定基準
- [ ] **経済合理性**: なぜ利益が生まれるかの説明

---

## 🔬 仮説検証プロセス

### Phase 1: 基礎検証

#### データ探索的分析
```python
# 仮説検証のためのデータ分析例
# 東京時間ブレイクアウト仮説の場合

1. 東京時間（8:00-9:00）のレンジ幅分析
2. レンジブレイク後のリターン分析
3. 時間帯別のボラティリティ分析
4. 成功率・失敗率の統計的検証
```

#### 基礎統計の確認
- [ ] **発生頻度**: 十分な検証機会があるか
- [ ] **基本統計**: 平均リターン、標準偏差、歪度
- [ ] **時系列安定性**: 期間による効果の変化
- [ ] **統計的有意性**: t検定等での優位性確認

### Phase 2: 戦略実装

#### 最小実行可能戦略（MVP）
```mql4
// 仮説検証用の最小実装例
// 複雑なフィルターは一切なし

if (現在時刻 == 東京市場開始 && 
    現在価格 > レンジ上限) {
    Buy();
}

if (現在時刻 == 東京市場終了 || 
    利益確定条件 || 
    損切り条件) {
    Close();
}
```

#### 実装時の注意点
- [ ] **パラメータ最小化**: 調整変数は3個以下
- [ ] **ハードコーディング**: 可能な限り固定値使用
- [ ] **フィルター回避**: 追加条件は後回し
- [ ] **シンプル優先**: 理解しやすさを最優先

### Phase 3: 統計的検証

#### 必須検証項目
1. **In-Sample / Out-of-Sample分析**
   - [ ] IS期間での基本性能確認
   - [ ] OOS期間での汎化性能確認
   - [ ] IS-OOS乖離率の評価

2. **ウォークフォワード分析**
   - [ ] 24ヶ月IS / 6ヶ月OOS設定
   - [ ] 各期間での一貫性確認
   - [ ] パラメータ安定性評価

3. **頑健性テスト**
   - [ ] 異なる市場環境での検証
   - [ ] 複数通貨ペアでの汎用性
   - [ ] パラメータ感度分析

---

## 📊 仮説評価基準

### 合格ライン
| 項目 | 基準 | 判定 |
|------|------|------|
| **OOS PF** | ≥ 1.1 | 必須 |
| **統計的有意性** | p < 0.05 | 必須 |
| **IS-OOS乖離** | < 50% | 推奨 |
| **WFA一貫性** | 80%期間で利益 | 推奨 |

### 不合格時の対応
1. **仮説の見直し**: 根本的前提の再検討
2. **実装の改善**: より純粋な仮説の実装
3. **条件の限定**: 有効な市場環境の特定
4. **新仮説の策定**: 完全に異なるアプローチ

---

## 🎯 具体的仮説例集

### 1. 時間的非効率性仮説
```
【仮説名】アジア-ロンドン時差ギャップ
【非効率性】時差による参加者入れ替わり時の価格発見遅延
【戦略】レンジ離脱時の初動トレンドフォロー
【検証方法】8-9時レンジ vs 9-12時リターン相関分析
```

### 2. 流動性非効率性仮説
```
【仮説名】薄商い時間帯の価格歪み
【非効率性】流動性低下時の大口注文による一時的価格歪み
【戦略】歪み発生後の正常価格への回帰狙い
【検証方法】ボリューム vs 価格変動率の関係分析
```

### 3. 情報処理非効率性仮説
```
【仮説名】経済指標発表時の反応遅延
【非効率性】指標内容の解釈・反映に時間差
【戦略】初期反応の方向継続性利用
【検証方法】指標発表前後の価格変動パターン分析
```

### 4. 行動ファイナンス仮説
```
【仮説名】週末明け月曜日のポジション調整
【非効率性】週末リスク回避後の再リスクテイク
【戦略】月曜日朝の方向性継続狙い
【検証方法】曜日効果の統計的検証
```

---

## 🚫 避けるべき偽仮説パターン

### データマイニング型偽仮説
```
❌ 「過去のデータを見ると、RSI30で反発することが多い」
→ 市場の非効率性が不明、後付けの観察
```

### 複雑化型偽仮説
```
❌ 「5つの指標が全て条件を満たした時にエントリー」
→ カーブフィッティングの可能性大
```

### 感情的偽仮説
```
❌ 「朝は上がりやすい気がする」
→ 主観的、検証不可能
```

### 都市伝説型偽仮説
```
❌ 「ゴトー日は円安になる」
→ 因果関係不明、統計的根拠薄弱
```

---

## 📚 仮説発想のためのリソース

### 市場構造理解のための情報源
1. **中央銀行レポート**: 日銀、FRB、ECBの市場分析
2. **学術論文**: 金融工学・行動ファイナンス系
3. **業界レポート**: BIS、IMF等の国際機関分析
4. **技術文献**: HFT、アルゴリズム取引に関する研究

### 非効率性発見のためのアプローチ
1. **時間軸分析**: 異なる時間帯の特性比較
2. **参加者分析**: 機関・個人・HFTの行動パターン
3. **商品特性分析**: 通貨ペア固有の特徴
4. **制度分析**: 規制・税制等の影響

---

## 🎊 成功事例の特徴

### 堅牢な仮説の共通点
1. **シンプルな核心**: 1つの明確な非効率性にフォーカス
2. **経済的根拠**: なぜその現象が起こるかの明確な説明
3. **持続性**: 構造的要因による継続的な優位性
4. **測定可能性**: 客観的な検証が可能

### 実装の特徴
1. **パラメータ最小**: 3個以下の調整変数
2. **ルール明確**: 誰でも再現可能な条件
3. **時間制限**: 無制限に保有しない
4. **損切り徹底**: 仮説が崩れた時の即座の撤退

---

**🏆 このガイドラインに従い、明確な市場仮説に基づく戦略開発を行うことで、過学習を避け、真の市場優位性を獲得できます。**